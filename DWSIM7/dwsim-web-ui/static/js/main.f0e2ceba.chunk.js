(this["webpackJsonpdwsim-web-ui"]=this["webpackJsonpdwsim-web-ui"]||[]).push([[0],{186:function(e,t,i){},187:function(e,t,i){},194:function(e,t,i){"use strict";i.r(t),t.default="data:image/png;base64,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"},195:function(e,t,i){"use strict";i.r(t),t.default=i.p+"static/media/folder.d9362600.svg"},201:function(e,t,i){"use strict";i.r(t);var n,r,s,a,o=i(0),l=i(94),c=i.n(l),d=i(125),u=(i(186),i(21)),f=(i(187),i(22)),h=i(18),p=i(2),m=i.n(p),v=i(14),b=i(141),x=i(6),j=i(8),g=i(53),w=i(40),y=i(41);!function(e){e.Folder="folder",e.File="file"}(n||(n={})),function(e){e.SteadyState="steady-state",e.Dynamic="dynamic"}(r||(r={})),function(e){e.Valid="valid",e.NotValid="not-valid",e.NotTested="not-tested"}(s||(s={})),function(e){e.Converged="converged",e.NotConverged="not-converged",e.NotTested="not-tested"}(a||(a={}));function O(e){var t=!!e.folder,i={};return i.key=e.id,i.eTag=e.eTag,i.name=e.name,i.iconName=t?"FabricFolder":void 0,i.extension=t?"folder":function(e){var t=e.split(".");return t&&t.length>1?t.pop():void 0}(e.name),i.remark=e.listItem.fields.Remark,i.dateModified=e.listItem.fields.Modified?new Date(e.listItem.fields.Modified):new Date(e.lastModifiedDateTime),i.remark=e.listItem.fields.Remark,i.versionNumber=e.listItem.fields._UIVersionString,i.simulationType=e.listItem.fields.Simulation_x0020_Type,i.specControlStatus=e.listItem.fields.SpecControl,i.convergedStatus=e.listItem.fields.Convergance,i.isExample=!!e.listItem.fields.ExampleFile&&e.listItem.fields.ExampleFile,i.hideFromDashboard=!!e.listItem.fields.HideFromDashboard&&e.listItem.fields.HideFromDashboard,i.isExam=!!e.listItem.fields.IsExam&&e.listItem.fields.IsExam,i.examId=e.listItem.fields.ExamId,i.createdFromFilterId=e.listItem.fields.CreatedFromFilterId,i.createdFromFilterVersionId=e.listItem.fields.CreatedFromFilterVersionId,i.fileType=t?n.Folder:n.File,i.listItemId=e.listItem.id,i.driveItemId=e.id,i.downloadURL=e["@microsoft.graph.downloadUrl"],i.tags=e.listItem.fields.Tags?e.listItem.fields.Tags.map((function(e){return{key:e.LookupId,name:e.LookupValue}})):null,i.createdBy=e.createdBy&&e.createdBy.user?e.createdBy.user:void 0,i.parentPath=e.parentReference.path,i.shared=!!e.shared,i}var k=i(153),I=i(276),F=i(5),S=window.localStorage.getItem("s365_local_user_token");var C=function(){var e=Object(v.a)(m.a.mark((function e(t){var i,n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("GetToken called",chrome.webview),!chrome.webview){e.next=20;break}if(i=chrome.webview.hostObjects.authService){e.next=6;break}return t("Auth Service not Found.",null),e.abrupt("return");case 6:return e.prev=6,e.next=9,i.getUserToken();case 9:n=e.sent,t(null,n),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(6),console.log("An error occurred while getting token.",e.t0),r={message:"An error occurred while getting token.",error:e.t0},t(r,null);case 18:e.next=23;break;case 20:console.log("Auth Service not found, using hardcoded token"),t(null,S);case 23:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(t){return e.apply(this,arguments)}}(),D={authProvider:C},A=k.a.init(D),R=i(72),W=i.n(R);function M(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t;return e.slice(0).sort((function(e,t){return N(e[n],t[n],i)}))}function N(e,t,i){if(/^\d*(\.\d+)?$/.test(e))return(i?Number(e)<Number(t):Number(e)>Number(t))?1:-1;if(W()(e,W.a.RFC_2822).isValid()){var n=Date.parse(e),r=Date.parse(t);return(i?n<r:n>r)?1:-1}return(i?e.toLowerCase()<t.toLowerCase():e.toLowerCase()>t.toLowerCase())?1:-1}function T(e,t,i,n){return L.apply(this,arguments)}function L(){return(L=Object(v.a)(m.a.mark((function e(t,i,r,s){var a,o,l,c,d,u,f,p,v,b;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.webUrl.split("/").slice(1).reduce((function(e,t){return e+"/"+t}),""),o="/sites/".concat(i,"/lists/").concat(r,"/drive/root:/").concat(a,":/children"),console.log("get drive items apiPath:",o,A),l=[],e.next=7,A.api(o).expand("listItem($expand=fields)").get();case 7:c=e.sent,l.push.apply(l,Object(h.a)(c.value));case 9:if(!c["@odata.nextLink"]){e.next=16;break}return e.next=12,A.api(c["@odata.nextLink"]).get();case 12:c=e.sent,l.push.apply(l,Object(h.a)(c.value)),e.next=9;break;case 16:return console.log("Drive items:",l),d=[],d=(d=l.map((function(e){return O(e)}))).filter((function(e){return!1===e.hideFromDashboard})),u=d.filter((function(e){return e.fileType===n.File&&!!e.extension&&s.findIndex((function(t){return t==e.extension}))>-1})),f=d.filter((function(e){return e.fileType===n.Folder})),p=M(f,"name",!1),v=M(u,"name",!1),b={files:v,folders:p},console.log("getSharedFlowsheetsItems results:",b),e.abrupt("return",b);case 29:e.prev=29,e.t0=e.catch(0),console.log("Error while getting List items:",e.t0);case 32:case"end":return e.stop()}}),e,null,[[0,29]])})))).apply(this,arguments)}function P(){return(P=Object(v.a)(m.a.mark((function e(t,i){var n,r,s,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(n=chrome)||void 0===n||null===(r=n.webview)||void 0===r||null===(s=r.hostObjects)||void 0===s?void 0:s.filePickerService)){e.next=6;break}return a=chrome.webview.hostObjects.filePickerService,e.next=4,a.openFile(t,i);case 4:e.next=7;break;case 6:throw"filePickerService not initialized.";case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(){return(U=Object(v.a)(m.a.mark((function e(t,i,n,r){var s,a,o,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(s=chrome)||void 0===s||null===(a=s.webview)||void 0===a||null===(o=a.hostObjects)||void 0===o?void 0:o.filePickerService)){e.next=6;break}return l=chrome.webview.hostObjects.filePickerService,e.next=4,l.SaveFile(t,i,n,r);case 4:e.next=7;break;case 6:throw"filePickerService not initialized.";case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e,t,i){return X.apply(this,arguments)}function X(){return(X=Object(v.a)(m.a.mark((function e(t,i,n){var r,s,a,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(r=chrome)||void 0===r||null===(s=r.webview)||void 0===s||null===(a=s.hostObjects)||void 0===a?void 0:a.filePickerService)){e.next=6;break}return o=chrome.webview.hostObjects.filePickerService,e.next=4,o.CreateFolder(t,i,n);case 4:e.next=7;break;case 6:throw"filePickerService not initialized.";case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var H=i(4),E=i(265),q=i(74),z=i(266),V=i(275),G=i(157),Q=i(270),Z=i(264),J=i(280),Y=i(267),K=i(11),_=i(43),$=i(155),ee=function(e){return e.IconUrl?Object(F.jsx)("img",Object(u.a)({src:e.IconUrl,className:e.className},e)):Object(F.jsx)($.a,Object(u.a)(Object(u.a)({},e),{},{onClick:e.onClick}))},te=i(282),ie={dwxml:{extensions:["dwxml","dwxmz"],imageUrl:i(194)},folder:{extensions:["folder"],imageUrl:i(195)}},ne=function(e){var t,i=function(e){if(e&&""!=e)for(var t in ie){var i=ie[t].extensions;if(i)for(var n=0;n<i.length;n++)if(i[n].toLowerCase()==e.toLowerCase())return ie[t].imageUrl}return""}(null!==(t=e.extension)&&void 0!==t?t:"").default;return console.log("IconURl",i),i&&null!==i&&""!==i?Object(u.a)({IconUrl:i},e):Object(te.a)(e)};var re=i(284),se=i(271),ae=function(e){Object(w.a)(i,e);var t=Object(y.a)(i);function i(e){var n;return Object(x.a)(this,i),(n=t.call(this,e)).state={folders:[e.baseFolder]},n}return Object(j.a)(i,[{key:"componentDidUpdate",value:function(e,t){var i=this,n=t.folders;n.find((function(e){return e.driveId===i.props.selectedFolder.driveId}))||(console.log("Navigating to:",this.props.selectedFolder),this.setState({folders:[].concat(Object(h.a)(n),[this.props.selectedFolder])}))}},{key:"getSelectedFolder",value:function(){var e=Object(v.a)(m.a.mark((function e(t){var i,n,r,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.props.baseFolder.webUrl){e.next=2;break}return e.abrupt("return",Object(u.a)({},this.props.baseFolder));case 2:return console.log("CurrentFolder path:",t),i=t.split("/").slice(1).reduce((function(e,t){return e+"/"+t}),""),console.log("getSelectedFolder path:",i),n="/sites/".concat(this.props.siteId,"/lists/").concat(this.props.flowsheetsListId,"/drive"),i&&""!==i&&"/"!==i&&(n="/sites/".concat(this.props.siteId,"/lists/").concat(this.props.flowsheetsListId,"/drive/root:").concat(i)),e.next=9,A.api(n).get();case 9:return r=e.sent,s={driveId:r.id,displayName:r.name,webUrl:t},e.abrupt("return",s);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBreadcrumbItems",value:function(){var e=this;return this.state.folders.map((function(t,i){var n=e.state.folders.length-1==i;return{text:t.displayName,key:i.toString(),onClick:function(){return e._onBreadcrumbItemClicked.call(e,i)},isCurrentItem:n}}))}},{key:"_onBreadcrumbItemClicked",value:function(e){var t=this.state.folders;t.splice(e+1),this.setState({folders:t}),this.props.onSelectedFolderChanged(t[t.length-1])}},{key:"onNavigateUpClick",value:function(){var e=this.state.folders;e.length>1&&(e.pop(),this.setState({folders:e}),this.props.onSelectedFolderChanged(e[e.length-1]))}},{key:"render",value:function(){var e=this.getBreadcrumbItems(),t=e.findIndex((function(e){return e.isCurrentItem})),i=this.state.folders[t].driveId!==this.props.baseFolder.driveId;return Object(F.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[i&&Object(F.jsx)(re.a,{iconProps:{iconName:"Up"},styles:{root:{margin:"11px 0px 1px"}},onClick:this.onNavigateUpClick.bind(this)}),Object(F.jsx)("div",{style:{minWidth:"100%"},children:Object(F.jsx)(se.a,{items:e,maxDisplayedItems:3})})]})}}]),i}(o.Component),oe=ae,le=i(59),ce=i(272),de=i(156),ue=i(154),fe={isBlocking:!0,topOffsetFixed:!0},he={type:le.a.normal,title:"Create Folder"},pe=function(e){var t=Object(ue.a)(),i=t.register,n=t.handleSubmit,r=(t.watch,t.formState.errors),s=function(){var t=Object(v.a)(m.a.mark((function t(i){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B(i.foldername,e.flowsheetsDriveId,e.selectedFolder.driveId);case 2:e.onFolderCreated();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return console.log("errors",r),Object(F.jsx)(ce.a,{hidden:!1,dialogContentProps:he,onDismiss:e.onHide,minWidth:"350px",modalProps:fe,children:Object(F.jsxs)("form",{onSubmit:n(s),children:[Object(F.jsx)(V.a,Object(u.a)(Object(u.a)({},i("foldername",{required:!0})),{},{placeholder:"Folder name"})),r.foldername&&Object(F.jsx)("span",{className:"text-danger",style:{margin:"3px 5px"},children:"Folder name is required."}),Object(F.jsxs)(de.a,{children:[Object(F.jsx)(Z.a,{type:"submit",text:"Create"}),Object(F.jsx)(G.a,{onClick:e.onHide,text:"Cancel"})]})]})})},me={root:{selectors:{".ms-DetailsRow":{minWidth:"calc(100vw - 50px) !important"}}}},ve=Object(H.E)({header:{margin:0,height:"50px"},row:{flex:"0 0 auto"},wrapper:{height:"40vh",position:"relative",backgroundColor:"white"},fileIconHeaderIcon:{padding:0,fontSize:"16px"},fileIconCell:{display:"flex !important",alignItems:"center",textAlign:"center",selectors:{"&:before":{content:".",display:"inline-block",verticalAlign:"middle",height:"100%",width:"0px",visibility:"hidden"}}},fileIconImg:{verticalAlign:"middle",maxHeight:"20px",maxWidth:"20px"},controlWrapper:{display:"flex",flexWrap:"wrap"},exampleToggle:{display:"inline-block",marginBottom:"10px",marginRight:"30px"},selectionDetails:{marginBottom:"20px"},commandbarInfoIcon:{border:"none"},remarkCell:{whiteSpace:"pre-line !important",selectors:{span:Object(u.a)(Object(u.a)({overflow:"hidden !important",textOverflow:"ellipsis !important",display:"-webkit-box !important"},{"-webkit-line-clamp":"2 !important"}),{"-webkit-box-orient":"vertical !important"})}},dateModifiedColumn:{textAlign:"center",justifyContent:"center",selectors:{".ms-DetailsHeader-cellTitle":{justifyContent:"center",paddingRight:"32px"}}},column:{display:"flex !important",textAlign:"center",justifyContent:"center",alignItems:"center",selectors:{".ms-DetailsHeader-cellTitle":{justifyContent:"center"}}},sharedColumn:{textAlign:"center",justifyContent:"center",alignItems:"center",fontSize:"18px",selectors:{".ms-DetailsHeader-cellTitle":{justifyContent:"center"}}},breadcrumbsticky:{height:"100px"},tableStyle:{selectors:{".ms-DetailsRow-cell":Object(u.a)(Object(u.a)({},{display:"flex !important"}),{},{alignItems:"center"})}}}),be=function(e){Object(w.a)(i,e);var t=Object(y.a)(i);function i(e){var r;return Object(x.a)(this,i),(r=t.call(this,e))._navigationBarRef=void 0,r._selection=void 0,r.getColumns=function(){var e={display:"flex",flexDirection:"row",flex:1,alignItems:"center"},t={overflow:"hidden"};return[{key:"file-type",name:"File Type",className:ve.fileIconCell,iconClassName:ve.fileIconHeaderIcon,ariaLabel:"Column operations for File type, Press to sort on File type",iconName:"Page",isIconOnly:!0,fieldName:"icon",minWidth:18,maxWidth:20,onRender:function(e){e.fileType,n.Folder;return Object(F.jsx)(ee,Object(u.a)({},ne({extension:e.extension,size:20,width:20,height:20})))}},{key:"name",name:"Name",fieldName:"name",minWidth:150,maxWidth:400,isRowHeader:!0,isResizable:!0,className:ve.column,data:"string",onRender:function(i,r){i.fileType,n.Folder;return Object(F.jsx)("div",{className:"document-name-container",style:e,children:Object(F.jsx)("div",{className:"document-name",style:t,children:i.name?Object(F.jsx)("span",{className:"kt-font-bold",children:i.name}):null})})}},{key:"date",name:"Modified At",fieldName:"dateModified",minWidth:135,maxWidth:200,isResizable:!0,isCollapsible:!0,isMultiline:!0,headerClassName:ve.dateModifiedColumn,className:ve.dateModifiedColumn,data:"string",onRender:function(e){return Object(F.jsxs)("span",{children:[W()(e.dateModified).format("ddd DD MMM YYYY"),Object(F.jsx)("br",{}),W()(e.dateModified).format("HH:mm:ss"),"  "]})},isPadded:!0},{key:"tags",name:"Tags",fieldName:"tags",minWidth:180,maxWidth:250,isResizable:!0,isCollapsible:!0,data:"string",onRender:function(e){if(e.tags&&e.tags.length>0){var t=e.tags.reduce((function(e,t,i,n){Object(b.a)(n);return{key:1..toString(),name:e.name+", "+t.name,isNewItem:!1}}));return Object(F.jsx)("span",{style:{whiteSpace:"initial"},children:t.name})}return Object(F.jsx)("span",{})},isPadded:!0},{key:"remark",name:"Remark",fieldName:"remark",minWidth:80,maxWidth:350,isResizable:!0,isCollapsible:!0,isMultiline:!0,className:ve.remarkCell,data:"string",onRender:function(e){return Object(F.jsx)("span",{children:e.remark})}}]},r.onRenderDetailsHeader=function(e,t){var i=r.props,n=i.siteId,s=i.baseFolder,a=i.flowsheetsListId;return Object(F.jsxs)(E.a,{stickyPosition:q.a.Header,stickyBackgroundColor:"white",children:[Object(F.jsx)(oe,{ref:r._navigationBarRef,siteId:n,flowsheetsListId:a,baseFolder:s,selectedFolder:r.state.selectedFolder,onSelectedFolderChanged:function(e){r.setState({selectedFolder:e},(function(){r.getFilesAndFolders()}))}}),t(e)]},"header_sticky")},r.state={files:[],folders:[],selectedFolder:e.baseFolder,isDataLoaded:!1,filename:"",selectedFileType:"dwxmz",filterFileTypes:["dwxml","dwxmz"],showCreateFolderModal:!1},r._navigationBarRef=o.createRef(),r._selection=new z.a({onSelectionChanged:r.selectedRowChanged.bind(Object(g.a)(r))}),r}return Object(j.a)(i,[{key:"componentDidMount",value:function(){this.props.isSaveDialog?this.changeFileTypeFilter():this.getFilesAndFolders()}},{key:"changeFileTypeFilter",value:function(){var e,t,i=this;if(null===(e=this.props.match)||void 0===e||null===(t=e.params)||void 0===t?void 0:t.extension){var n,r,s=this.props.match.params.extension.split("_");this.setState({selectedFileType:s[0],filterFileTypes:s},(function(){i.getFilesAndFolders()})),console.log("Query params",null===(n=this.props.match)||void 0===n||null===(r=n.params)||void 0===r?void 0:r.extension)}else this.getFilesAndFolders()}},{key:"getFilesAndFolders",value:function(){var e=Object(v.a)(m.a.mark((function e(){var t,i,n,r,s,a,o,l,c,d,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state,i=t.selectedFolder,n=t.filterFileTypes,r=t.selectedFileType,s=this.props,a=s.siteId,o=s.flowsheetsListId,e.prev=2,this.setState({isDataLoaded:!1}),d="dwxml"==r||"dwxmz"==r?n:[r],e.next=7,T(i,a,o,d);case 7:u=e.sent,console.log("Files and folders",u),this.setState({files:null!==(l=u.files)&&void 0!==l?l:[],folders:null!==(c=u.folders)&&void 0!==c?c:[]}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.log("An error occurred while loading dashboard files",e.t0);case 15:return e.prev=15,this.setState({isDataLoaded:!0}),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));return function(){return e.apply(this,arguments)}}()},{key:"selectedRowChanged",value:function(){var e=this,t=this._selection.getSelection(),i=this.state.selectedFolder,r=this.props.isSaveDialog;if(t&&t.length>0){var s=t[0];if(s.fileType==n.Folder){var a="/".concat(encodeURIComponent(s.name));a=this.state.selectedFolder.webUrl+a;var o={driveId:s.driveItemId,displayName:s.name,webUrl:a,parentDriveItemId:i.driveId};console.log("Setting selected folder",o),this.setState({selectedFolder:o},(function(){e.getFilesAndFolders()}))}else if(r){var l=s.name.split(".");l.length>1&&l.pop();var c=l.reduce((function(e,t){return e+t}),"");this.setState({filename:c})}else(function(e,t){return P.apply(this,arguments)})(s.driveItemId,this.props.flowsheetsDriveId).then((function(){}),(function(e){alert(e)}))}}},{key:"onSaveFileClick",value:function(){console.log("Save clicked",this.state);var e=this.state,t=e.filename,i=e.selectedFileType,n=e.selectedFolder,r=this.props.flowsheetsDriveId;t&&i&&function(e,t,i,n){U.apply(this,arguments)}(t,i,r,n.driveId)}},{key:"render",value:function(){var e=this,t=this.state,i=t.folders,n=t.files,r=t.isDataLoaded,s=t.selectedFolder,a=t.filename,o=t.selectedFileType,l=t.filterFileTypes,c=t.showCreateFolderModal,d=this.props.isSaveDialog,u=this.props,f=(u.siteId,u.flowsheetsListId,u.baseFolder,Object(h.a)(this.getColumns())),p=[].concat(Object(h.a)(i),Object(h.a)(n));console.log("isDataLoaded",r);var m=function(e){var t=[];return e.forEach((function(e){var i=function(e){switch(e){case"dwxmz":return{key:"dwxmz",text:"Simulation File (Compressed XML) (*.dwxmz)"};case"xlsx":return{key:"xlsx",text:"Excel Workbook (*.xlsx)"};case"odt":return{key:"odt",text:"OpenOffice Writer Document (*.odt)"};case"pdf":return{key:"pdf",text:"PDF Files (*.pdf)"};case"ods":return{key:"ods",text:"OpenOffice Calc SpreadSheet (*.ods)"};default:return}}(e);i&&t.push(i)})),t}(l);return Object(F.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[d&&Object(F.jsxs)("div",{style:{marginLeft:"30px"},children:[Object(F.jsxs)("div",{style:{display:"flex",marginBottom:"5px",marginTop:"5px"},children:[Object(F.jsx)("div",{style:{flexBasis:"80%"},children:Object(F.jsx)(V.a,{placeholder:"Enter file name here",value:a,onChange:function(t,i){return e.setState({filename:i})}})}),Object(F.jsx)("div",{style:{flexBasis:"20%"},children:Object(F.jsx)(G.a,{text:"New Folder",styles:{root:{marginLeft:"10px"}},onClick:function(){return e.setState({showCreateFolderModal:!0})}})})]}),Object(F.jsxs)("div",{style:{display:"flex",marginBottom:"5px",marginTop:"5px"},children:[Object(F.jsx)("div",{style:{flexBasis:"80%"},children:Object(F.jsx)(Q.a,{selectedKey:o,placeholder:"Select an option",options:m,onChange:function(t,i){e.setState({selectedFileType:null===i||void 0===i?void 0:i.key.toString()},(function(){e.getFilesAndFolders()}))}})}),Object(F.jsx)("div",{style:{flexBasis:"20%"},children:Object(F.jsx)(Z.a,{text:"Save",styles:{root:{marginLeft:"10px"}},onClick:this.onSaveFileClick.bind(this)})})]}),c&&Object(F.jsx)(pe,{onFolderCreated:function(){e.setState({showCreateFolderModal:!1}),e.getFilesAndFolders()},selectedFolder:s,flowsheetsDriveId:this.props.flowsheetsDriveId,onHide:function(){return e.setState({showCreateFolderModal:!1})}})]}),Object(F.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"row",minHeight:"300px"},children:Object(F.jsx)("div",{style:{position:"relative",flex:1},children:Object(F.jsx)(J.a,{styles:{root:{marginLeft:"30px"}},children:Object(F.jsx)(Y.a,{enableShimmer:!r,items:p,columns:f,selection:this._selection,layoutMode:K.e.fixedColumns,constrainMode:K.d.unconstrained,onRenderDetailsHeader:this.onRenderDetailsHeader.bind(this),selectionMode:_.b.single,checkboxVisibility:K.a.hidden,onShouldVirtualize:function(){return!1},setKey:"none",detailsListStyles:me,isHeaderVisible:!0})})})})]})}}]),i}(o.Component);var xe,je=(xe=be,function(e){Object(w.a)(i,e);var t=Object(y.a)(i);function i(e){var n;return Object(x.a)(this,i),(n=t.call(this,e)).state={isLoaded:!1,siteId:"",flowsheetsDriveId:"",flowsheetsListId:""},n}return Object(j.a)(i,[{key:"componentDidMount",value:function(){var e=Object(v.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getBaseFolder();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBaseFolder",value:function(){var e=Object(v.a)(m.a.mark((function e(){var t,i,n,r,s,a,o,l,c,d,u,f;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("chrome.webview?.hostObjects?.authService",null===(t=chrome.webview)||void 0===t||null===(i=t.hostObjects)||void 0===i?void 0:i.authService),o=(null===(n=chrome.webview)||void 0===n||null===(r=n.hostObjects)||void 0===r?void 0:r.authService)?void 0:S,!(null===(s=chrome.webview)||void 0===s||null===(a=s.hostObjects)||void 0===a?void 0:a.authService)){e.next=14;break}return this.setState({isLoaded:!1}),l=chrome.webview.hostObjects.authService,e.prev=5,e.next=8,l.getUserToken();case 8:o=e.sent,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),o="";case 14:if(console.log("App.tsx token",o,!!o),e.prev=15,!(o&&o.length>0)){e.next=29;break}return c={userAccessToken:o,siteId:"not required",flowsheetsListId:"not required",tagsListId:"not required"},e.next=20,fetch("".concat("https://s365-dashboard.azurewebsites.net","/api/dashboard/initialize"),{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json"},referrerPolicy:"no-referrer",body:JSON.stringify(c)});case 20:return d=e.sent,e.next=23,d.json();case 23:u=e.sent,console.log("Initialize resp",u),f={webUrl:"/"+u.flowsheets.folderName,id:u.flowsheets.folderListId,driveId:u.flowsheets.folderDriveId,displayName:"Dashboard"},this.setState({baseFolder:f,siteId:u.siteId,flowsheetsDriveId:u.flowsheetsDriveId,flowsheetsListId:u.flowsheetsListId}),e.next=30;break;case 29:this.setState({isLoaded:!0});case 30:e.next=35;break;case 32:e.prev=32,e.t1=e.catch(15),console.log("An error occurred while initializing dashboard.",e.t1);case 35:return e.prev=35,this.setState({isLoaded:!0}),e.finish(35);case 38:case"end":return e.stop()}}),e,this,[[5,11],[15,32,35,38]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.isLoaded?Object(F.jsx)(xe,Object(u.a)(Object(u.a)({},this.props),this.state)):Object(F.jsx)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},children:Object(F.jsx)(I.a,{className:"main-spinner",styles:{circle:{width:"100px",height:"100px"}},label:"Loading Dashboard...",labelPosition:"bottom"})})}}]),i}(o.Component)),ge=i(23),we=function(){var e=function(){var e=Object(v.a)(m.a.mark((function e(){var t,i,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{(null===(t=chrome)||void 0===t||null===(i=t.webview)||void 0===i||null===(n=i.hostObjects)||void 0===n?void 0:n.systemService).openUrlInLocalBrowser("https://simulate365.com/registration-dwsim-pro/")}catch(r){console.log("An error occurred while navigating to register page.",r)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var e=Object(v.a)(m.a.mark((function e(){var t,i,n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(null===(t=chrome)||void 0===t||null===(i=t.webview)||void 0===i||null===(n=i.hostObjects)||void 0===n?void 0:n.authService)){e.next=7;break}return r=chrome.webview.hostObjects.authService,e.next=5,r.navigateToLoginPage();case 5:e.next=8;break;case 7:alert("auth Service not initialized.");case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("An error occurred while navigating to login page.",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return Object(F.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",padding:"0px 20px"},children:[Object(F.jsx)("div",{style:{marginLeft:"auto",marginRight:"auto",marginBottom:"16px"},children:Object(F.jsx)("a",{href:"https://simulate365.com",onClick:function(e){e.preventDefault();e.nativeEvent;var t,i=Object(ge.a)(e.nativeEvent.path);try{for(i.s();!(t=i.n()).done;){var n=t.value;if("A"==n.tagName){var r,s,a,o=null===(r=chrome)||void 0===r||null===(s=r.webview)||void 0===s||null===(a=s.hostObjects)||void 0===a?void 0:a.systemService;if(o){var l=n.href;o.openUrlInLocalBrowser(l)}else alert("SystemService not available.");return!1}}}catch(c){i.e(c)}finally{i.f()}return alert("OpenAnchorInSystemBrowser() supports only 'a' element. 'a' element not found in invocation path."),!1},children:Object(F.jsx)("img",{src:"/s365-full-logo.png",style:{width:"250px"}})})}),Object(F.jsxs)("p",{children:["Access ",Object(F.jsx)("b",{children:"Simulate 365 DASHBOARD"}),', the "all in one place" simulation platform and use it free for:',Object(F.jsxs)("ul",{children:[Object(F.jsx)("li",{children:"Intelligent file management"}),Object(F.jsx)("li",{children:"Syncing simulation files from DASHBOARD to DWSIM"}),Object(F.jsx)("li",{children:"Easier team collaboration"})]})]}),Object(F.jsxs)("div",{style:{marginLeft:"auto",marginRight:"auto",marginBottom:"16px"},children:[Object(F.jsx)(Z.a,{text:"Register",onClick:function(){return e()},style:{marginRight:"10px"}}),Object(F.jsx)(G.a,{text:"Login",onClick:function(){return t()}})]}),Object(F.jsxs)("p",{children:["Discover ",Object(F.jsx)("b",{children:"DWSIM Pro"})," and other Simulate 365 tools:",Object(F.jsxs)("ul",{children:[Object(F.jsx)("li",{children:"PPBDesigner for Population Balance Modeling"}),Object(F.jsx)("li",{children:"Multivariate Senstivity Study (MSS)"}),Object(F.jsx)("li",{children:"Design of Experiments (DoE)"}),Object(F.jsx)("li",{children:"Take-Home Exercises/Exams (THEE)"}),Object(F.jsx)("li",{children:"And more!"})]})]})]})},ye=function(){return Object(F.jsxs)("div",{className:"App",children:[Object(F.jsx)(f.a,{path:"/filepicker/open",exact:!0,component:je}),Object(F.jsx)(f.a,{path:"/filepicker/save/:extension?",exact:!0,render:function(e){return Object(F.jsx)(je,Object(u.a)({isSaveDialog:!0},e))}}),Object(F.jsx)(f.a,{path:"/login/intro",exact:!0,component:we})]})},Oe=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,287)).then((function(t){var i=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,a=t.getTTFB;i(e),n(e),r(e),s(e),a(e)}))},ke=i(269),Ie=i(268);Object(ke.a)(),Object(Ie.a)(),c.a.render(Object(F.jsx)(d.a,{children:Object(F.jsx)(ye,{})}),document.getElementById("root")),Oe()}},[[201,1,2]]]);
//# sourceMappingURL=main.f0e2ceba.chunk.js.map