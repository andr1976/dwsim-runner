{"version":3,"sources":["assets/icons/file-types/dwsim.png","assets/icons/file-types/folder.svg","interfaces/documents/document.interfaces.ts","shared/mappers/driveitem-document.mapper.ts","shared/utilities/get-file-extension.ts","components/with-initialize-dashboard.hoc.tsx","shared/ms-graph/ms-graph-factory.ts","shared/utilities/copy-sort.ts","api/documents.api.ts","components/file-type-icon/file-type-icon.component.tsx","components/file-type-icon/file-type-icon.data.ts","components/file-type-icon/file-type-icon.helpers.ts","components/navigation-bar/navigation-bar.component.tsx","components/create-folder-modal/create-folder-modal.component.tsx","pages/open-dashboard-file.component.tsx","pages/login-intro.component.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["ResponseItemType","SimulationType","SpecControlStatus","ConvergedStatus","MapDriveItemToDocument","item","isFolder","folder","document","key","id","eTag","name","iconName","undefined","extension","filename","filenameArray","split","length","pop","getFileExtension","remark","listItem","fields","Remark","dateModified","Modified","Date","lastModifiedDateTime","versionNumber","_UIVersionString","simulationType","Simulation_x0020_Type","specControlStatus","SpecControl","convergedStatus","Convergance","isExample","ExampleFile","hideFromDashboard","HideFromDashboard","isExam","IsExam","examId","ExamId","createdFromFilterId","CreatedFromFilterId","createdFromFilterVersionId","CreatedFromFilterVersionId","fileType","Folder","File","listItemId","driveItemId","downloadURL","tags","Tags","map","value","LookupId","LookupValue","createdBy","user","parentPath","parentReference","path","shared","user_token","window","localStorage","getItem","authProvider","callback","a","console","log","chrome","webview","authService","hostObjects","getUserToken","token","errorModel","message","error","options","msGraphClient","Client","init","_copyAndSort","items","columnKey","isSortedDescending","slice","sort","b","compareItems","test","Number","moment","RFC_2822","isValid","first","parse","second","toLowerCase","getFlowsheetListItemsAsync","selectedFolder","siteId","flowsheetsListId","filterFileTypes","selectedFolderPath","webUrl","reduce","prev","curr","apidrivePath","driveItems","api","expand","get","driveItemsResp","push","documents","driveItem","filter","files","findIndex","x","folders","sortedFolders","sortedFiles","filesAndFolders","driveId","filePickerService","openFile","flowsheetsDriveId","parentDriveId","SaveFile","CreateFolder","folderName","FileTypeIcon","props","IconUrl","src","className","Icon","onClick","CustomFileTypeToIconMap","dwxml","extensions","imageUrl","require","getFileTypeIconPropsCustom","i","getIconImageUrl","default","getFileTypeIconProps","NavigationBar","state","baseFolder","prevProps","prevState","find","this","setState","folderPath","apiPath","folderInfo","displayName","index","isCurrent","text","toString","_onBreadcrumbItemClicked","call","isCurrentItem","splice","onSelectedFolderChanged","getBreadcrumbItems","lastItem","showIcon","style","display","alignItems","IconButton","iconProps","styles","root","margin","onNavigateUpClick","bind","minWidth","Breadcrumb","maxDisplayedItems","React","modelProps","isBlocking","topOffsetFixed","dialogContentProps","type","DialogType","normal","title","CreateFolderModal","useForm","register","handleSubmit","errors","watch","formState","onSubmit","data","foldername","onFolderCreated","Dialog","hidden","onDismiss","onHide","modalProps","TextField","required","placeholder","DialogFooter","PrimaryButton","DefaultButton","gridStyles","selectors","classNames","mergeStyleSets","header","height","row","flex","wrapper","position","backgroundColor","fileIconHeaderIcon","padding","fontSize","fileIconCell","textAlign","content","verticalAlign","width","visibility","fileIconImg","maxHeight","maxWidth","controlWrapper","flexWrap","exampleToggle","marginBottom","marginRight","selectionDetails","commandbarInfoIcon","border","remarkCell","whiteSpace","overflow","textOverflow","dateModifiedColumn","justifyContent","paddingRight","column","sharedColumn","breadcrumbsticky","tableStyle","OpenDashboardFilePage","_navigationBarRef","_selection","getColumns","nameContainerStyle","flexDirection","documentNameStyle","iconClassName","ariaLabel","isIconOnly","fieldName","onRender","size","isRowHeader","isResizable","isCollapsible","isMultiline","headerClassName","format","isPadded","currindex","isNewItem","onRenderDetailsHeader","defaultRender","Sticky","stickyPosition","StickyPositionType","Header","stickyBackgroundColor","ref","getFilesAndFolders","isDataLoaded","selectedFileType","showCreateFolderModal","Selection","onSelectionChanged","selectedRowChanged","isSaveDialog","changeFileTypeFilter","match","params","fileTypeExtensions","fileTypes","selection","getSelection","encodeURIComponent","newSelectedFolder","parentDriveItemId","nameArray","fileName","OpenDwsimFile","then","alert","SaveDwsimFile","columns","dropdownControlledExampleOptions","fileExtensions","forEach","option","getFileTypeDropdownOption","getDropDownOptions","marginLeft","marginTop","flexBasis","onChange","ev","newValue","Dropdown","selectedKey","e","onSaveFileClick","minHeight","ScrollablePane","ShimmeredDetailsList","enableShimmer","layoutMode","DetailsListLayoutMode","fixedColumns","constrainMode","ConstrainMode","unconstrained","selectionMode","SelectionMode","single","checkboxVisibility","CheckboxVisibility","onShouldVirtualize","setKey","detailsListStyles","isHeaderVisible","withInitializeDashboard","WrappedComponent","isLoaded","getBaseFolder","userAccessToken","tagsListId","fetch","process","method","mode","cache","headers","referrerPolicy","body","JSON","stringify","resp","json","flowsheets","folderListId","folderDriveId","Spinner","circle","label","labelPosition","LoginIntroPage","onRegisterClick","systemService","openUrlInLocalBrowser","onLoginClick","navigateToLoginPage","href","preventDefault","nativeEvent","element","tagName","url","App","exact","component","render","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","initializeIcons","initializeFileTypeIcons","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.f0e2ceba.chunk.js","sourcesContent":["export default \"data:image/png;base64,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\"","export default __webpack_public_path__ + \"static/media/folder.d9362600.svg\";","export interface IDocument {\r\n    key: string;\r\n    eTag: string;\r\n    listItemId: number;\r\n    driveItemId: string;\r\n    name: string;\r\n    extension?: string;\r\n    iconName?: string;\r\n    iconNameUrl?: string;\r\n    fileType: ResponseItemType;\r\n    remark?: string;\r\n    versionId?: string;\r\n    simulationType?: SimulationType;\r\n    scenarioCount?: number;\r\n    filterCount?: number;\r\n    studyCount?: number;\r\n    dateModified: Date;\r\n    specControlStatus?: SpecControlStatus;\r\n    convergedStatus?: ConvergedStatus;\r\n    tags?: ITag[];\r\n    versionNumber?: number;\r\n    isVersion?: boolean;\r\n    isAnalyzed?: boolean;\r\n    isAnalyzedLoading?: boolean;\r\n    downloadURL?: string;\r\n    odataType: string;\r\n    editUrl: string;\r\n    createdBy?: IUser;\r\n    isExample: boolean;\r\n    isExam: boolean;\r\n    examId: number;\r\n    hideFromDashboard: boolean;\r\n    createdFromFilterId: string;\r\n    createdFromFilterVersionId: string;\r\n    parentPath?: string;\r\n    shared: boolean;\r\n}\r\n\r\nexport interface ISelectedFolder {\r\n    id: string;\r\n    driveId: string;\r\n    webUrl: string;\r\n    displayName: string;\r\n    parentDriveItemId: string;\r\n}\r\nexport  enum ResponseItemType {\r\n    Folder = \"folder\",\r\n    File = \"file\"\r\n}\r\nexport  enum SimulationType {\r\n    SteadyState = \"steady-state\",\r\n    Dynamic = \"dynamic\"\r\n}\r\nexport  enum SpecControlStatus {\r\n    Valid = \"valid\",\r\n    NotValid = \"not-valid\",\r\n    NotTested = \"not-tested\"\r\n}\r\nexport  enum ConvergedStatus {\r\n    Converged = \"converged\",\r\n    NotConverged = \"not-converged\",\r\n    NotTested = \"not-tested\"\r\n}\r\nexport interface ITag {\r\n    key: string;\r\n    name: string;\r\n    isNewItem: boolean;\r\n}\r\nexport interface IUser {\r\n    id?: string;\r\n    email?: string;\r\n    displayName?: string;\r\n}\r\n","import { IDocument, ITag, IUser, ResponseItemType } from \"../../interfaces/documents/document.interfaces\";\r\nimport { getFileExtension } from \"../utilities/get-file-extension\";\r\n\r\nexport function MapDriveItemToDocument(item: any): IDocument {\r\n    let isFolder: boolean = item.folder ? true : false;\r\n\r\n    let document = {} as IDocument;\r\n    document.key = item.id;\r\n    document.eTag = item.eTag;\r\n    document.name = item.name;\r\n    document.iconName = isFolder ? \"FabricFolder\" : undefined;\r\n    document.extension = isFolder ? \"folder\" : getFileExtension(item.name);\r\n\r\n    document.remark = item.listItem.fields.Remark;\r\n    document.dateModified = item.listItem.fields.Modified ? new Date(item.listItem.fields.Modified) : new Date(item.lastModifiedDateTime);\r\n    //document.iconNameUrl = !isFolder ? require(\"../../assets/filetype-icons/cc7.png\") : null;\r\n    document.remark = item.listItem.fields.Remark;\r\n    //document.versionId = item.UIVersion;\r\n    document.versionNumber = item.listItem.fields._UIVersionString;\r\n    document.simulationType = item.listItem.fields.Simulation_x0020_Type;\r\n    document.specControlStatus = item.listItem.fields.SpecControl;\r\n    document.convergedStatus = item.listItem.fields.Convergance;\r\n    document.isExample = item.listItem.fields.ExampleFile ? item.listItem.fields.ExampleFile : false;\r\n    document.hideFromDashboard = item.listItem.fields.HideFromDashboard ? item.listItem.fields.HideFromDashboard : false;\r\n    document.isExam = item.listItem.fields.IsExam ? item.listItem.fields.IsExam : false;\r\n    document.examId= item.listItem.fields.ExamId;\r\n    document.createdFromFilterId = item.listItem.fields.CreatedFromFilterId;\r\n    document.createdFromFilterVersionId = item.listItem.fields.CreatedFromFilterVersionId;\r\n    document.fileType = isFolder ? ResponseItemType.Folder : ResponseItemType.File;\r\n    document.listItemId = item.listItem.id;\r\n    document.driveItemId = item.id;\r\n    document.downloadURL = item[\"@microsoft.graph.downloadUrl\"];\r\n    document.tags = item.listItem.fields.Tags ? item.listItem.fields.Tags.map((value:any) => {\r\n        return { key: value.LookupId, name: value.LookupValue } as ITag;\r\n    }) : null;\r\n    document.createdBy = (item.createdBy && item.createdBy.user) ? (item.createdBy.user as IUser) : undefined;\r\n    document.parentPath = item.parentReference.path;\r\n    document.shared = item.shared ? true : false;\r\n    return document;\r\n}","export const getFileExtension = (filename: string) => {\r\n    var filenameArray = filename.split('.');\r\n    if (filenameArray && filenameArray.length > 1) {\r\n        return filenameArray.pop();\r\n    } else {\r\n        return undefined;\r\n    }\r\n}","import * as React from \"react\";\r\nimport { Spinner } from \"@fluentui/react\";\r\nimport { ISelectedFolder } from \"../interfaces/documents/document.interfaces\";\r\ndeclare const chrome: any;\r\n\r\n\r\n\r\nexport interface IInitializeDashboardProps {\r\n    baseFolder?: ISelectedFolder;\r\n    isLoaded: boolean;\r\n    siteId: string;\r\n    flowsheetsListId: string;\r\n    flowsheetsDriveId: string;\r\n}\r\n\r\nexport const user_token = window.localStorage.getItem(\"s365_local_user_token\");\r\nconst DashboardServiceUrl = process.env.REACT_APP_DASHBOARD_SERVICE_URL;\r\n\r\n\r\nexport function withInitializeDashboard(WrappedComponent: any) {\r\n\r\n    return class extends React.Component<{}, IInitializeDashboardProps>{\r\n\r\n        /**\r\n         *\r\n         */\r\n        constructor(props: IInitializeDashboardProps) {\r\n            super(props);\r\n            this.state = {\r\n                isLoaded: false,\r\n                siteId: \"\",\r\n                flowsheetsDriveId: \"\",\r\n                flowsheetsListId: \"\"\r\n            };\r\n        }\r\n\r\n        async componentDidMount() {\r\n            await this.getBaseFolder();\r\n        }\r\n        async getBaseFolder() {\r\n            console.log(\"chrome.webview?.hostObjects?.authService\", chrome.webview?.hostObjects?.authService);\r\n            let token = !chrome.webview?.hostObjects?.authService ? user_token : undefined;\r\n            if (chrome.webview?.hostObjects?.authService) {\r\n                this.setState({ isLoaded: false });\r\n\r\n                const authService = chrome.webview.hostObjects.authService;\r\n                try {\r\n                    token = await authService.getUserToken();\r\n                } catch (error) {\r\n\r\n                    token = \"\";\r\n                }\r\n            }\r\n            console.log(\"App.tsx token\", token, !!token);\r\n            try {\r\n                if (!!token && token.length > 0) {\r\n                    const data = {\r\n                        userAccessToken: token,\r\n                        siteId: \"not required\",\r\n                        flowsheetsListId: \"not required\",\r\n                        tagsListId: \"not required\"\r\n                    };\r\n\r\n                    const resp = await fetch(`${DashboardServiceUrl}/api/dashboard/initialize`, {\r\n                        method: 'POST', // *GET, POST, PUT, DELETE, etc.\r\n                        mode: 'cors', // no-cors, *cors, same-origin\r\n                        cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached\r\n                        // credentials: 'same-origin', // include, *same-origin, omit\r\n                        headers: {\r\n                            'Content-Type': 'application/json'\r\n                            // 'Content-Type': 'application/x-www-form-urlencoded',\r\n                        },\r\n                        // redirect: 'follow', // manual, *follow, error\r\n                        referrerPolicy: 'no-referrer', // no-referrer, *no-referrer-when-downgrade, origin, origin-when-cross-origin, same-origin, strict-origin, strict-origin-when-cross-origin, unsafe-url\r\n                        body: JSON.stringify(data) // body data type must match \"Content-Type\" header\r\n                    });\r\n                    const folder = await resp.json();\r\n                    console.log(\"Initialize resp\", folder);\r\n                    const baseFolder = {\r\n                        // webUrl: folder.flowsheets.parentName + \"/\" + folder.flowsheets.folderName,\r\n                        webUrl: \"/\" + folder.flowsheets.folderName,\r\n                        id: folder.flowsheets.folderListId,\r\n                        driveId: folder.flowsheets.folderDriveId,\r\n                        displayName: \"Dashboard\"\r\n                    } as ISelectedFolder;\r\n\r\n                    this.setState({\r\n                        baseFolder: baseFolder,\r\n                        siteId: folder.siteId,\r\n                        flowsheetsDriveId: folder.flowsheetsDriveId,\r\n                        flowsheetsListId: folder.flowsheetsListId\r\n                    });\r\n                } else {\r\n                    this.setState({ isLoaded: true });\r\n                }\r\n            }\r\n            catch (error) {\r\n                console.log(\"An error occurred while initializing dashboard.\", error);\r\n            } finally {\r\n                this.setState({ isLoaded: true });\r\n            }\r\n\r\n        }\r\n\r\n\r\n        render() {\r\n            const { isLoaded } = this.state;\r\n\r\n            if (!isLoaded) {\r\n                return (<div style={{\r\n                    display: \"flex\",\r\n                    flexDirection: \"column\",\r\n                    alignItems: \"center\",\r\n                    justifyContent: \"center\",\r\n                    height: \"100%\"\r\n                }}>\r\n\r\n                    <Spinner\r\n                        className=\"main-spinner\"\r\n                        styles={{ circle: { width: \"100px\", height: \"100px\" } }}\r\n                        label=\"Loading Dashboard...\"\r\n                        labelPosition=\"bottom\" />\r\n\r\n                </div>);\r\n\r\n            }\r\n            else\r\n\r\n                return <WrappedComponent {...this.props} {...this.state} />\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\n","import { AuthProvider, AuthProviderCallback, Client, Options } from \"@microsoft/microsoft-graph-client\";\r\nimport {user_token} from \"../../components/with-initialize-dashboard.hoc\";\r\ndeclare const chrome: any;\r\n\r\n// Some callback function\r\nconst authProvider: AuthProvider = async (callback: AuthProviderCallback) => {\r\n    // Your logic for getting and refreshing accessToken\r\n    console.log(\"GetToken called\", chrome.webview);\r\n    if (chrome.webview) {\r\n        const authService = chrome.webview.hostObjects.authService;\r\n        if (!authService) {\r\n            callback(\"Auth Service not Found.\", null); return;\r\n        }\r\n\r\n        try {\r\n            const token = await authService.getUserToken();\r\n            callback(null, token);\r\n        } catch (error) {\r\n            console.log(\"An error occurred while getting token.\",error);\r\n            const errorModel = { message: \"An error occurred while getting token.\", error: error };\r\n            callback(errorModel, null);\r\n        }\r\n\r\n\r\n    } else {\r\n        console.log(\"Auth Service not found, using hardcoded token\");\r\n        //for test cases using browser\r\n        const token = user_token;\r\n        callback(null, token);\r\n\r\n    }\r\n\r\n\r\n};\r\nlet options: Options = {\r\n    authProvider,\r\n};\r\nexport const msGraphClient = Client.init(options);","import moment from \"moment\";\r\n\r\nexport function _copyAndSort<T>(items: T[], columnKey: string, isSortedDescending: boolean=false): T[] {\r\n  const key = columnKey as keyof T;\r\n  // console.log(\"sorting items:\", items);\r\n  return items.slice(0).sort((a: T, b: T) => (compareItems(a[key], b[key], isSortedDescending)));\r\n}\r\n\r\nfunction compareItems(a: any, b: any, isSortedDescending: boolean): number {\r\n  if (/^\\d*(\\.\\d+)?$/.test(a)) {\r\n    //  console.log(\"sorting numbers\", a, b, isSortedDescending);\r\n    return (isSortedDescending ? Number(a) < Number(b) : Number(a) > Number(b)) ? 1 : -1;\r\n  }\r\n  else if (moment(a, moment.RFC_2822).isValid()) {\r\n    //  console.log(\"sorting dates\", a, b, isSortedDescending);\r\n    const first = Date.parse(a);\r\n    const second = Date.parse(b);\r\n    return (isSortedDescending ? first < second : first > second) ? 1 : -1;\r\n\r\n\r\n  }\r\n  else {\r\n    //  console.log(\"sorting strings\", a, b, isSortedDescending);\r\n    return (isSortedDescending ? (a as string).toLowerCase() < (b as string).toLowerCase()\r\n      : (a as string).toLowerCase() > (b as string).toLowerCase()) ? 1 : -1;\r\n\r\n  }\r\n}","\r\nimport { IDocument, ISelectedFolder, ResponseItemType } from \"../interfaces/documents/document.interfaces\";\r\nimport { MapDriveItemToDocument } from \"../shared/mappers/driveitem-document.mapper\";\r\nimport { msGraphClient } from \"../shared/ms-graph/ms-graph-factory\";\r\nimport { _copyAndSort } from \"../shared/utilities/copy-sort\";\r\ndeclare const chrome: any;\r\n\r\nexport async function getFlowsheetListItemsAsync(selectedFolder: ISelectedFolder, siteId: string, flowsheetsListId: string, filterFileTypes: string[]) {\r\n    try {\r\n        const selectedFolderPath = selectedFolder.webUrl.split('/').slice(1).reduce((prev, curr) => prev + \"/\" + curr, \"\");\r\n\r\n        let apidrivePath = `/sites/${siteId}/lists/${flowsheetsListId}/drive/root:/${selectedFolderPath}:/children`;\r\n\r\n\r\n        console.log(\"get drive items apiPath:\", apidrivePath, msGraphClient);\r\n        let driveItems = [];\r\n\r\n        let driveItemsResp = await msGraphClient.api(apidrivePath).expand(\"listItem($expand=fields)\").get();\r\n        driveItems.push(...driveItemsResp.value);\r\n        while (driveItemsResp[\"@odata.nextLink\"]) {\r\n            driveItemsResp = await msGraphClient.api(driveItemsResp[\"@odata.nextLink\"]).get();\r\n            driveItems.push(...driveItemsResp.value);\r\n        }\r\n        console.log(\"Drive items:\", driveItems);\r\n\r\n        let documents: IDocument[] = [];\r\n\r\n        documents = driveItems.map(driveItem => MapDriveItemToDocument(driveItem));\r\n        //remove hide from dashboard files\r\n        documents = documents.filter(document => document.hideFromDashboard === false);\r\n\r\n        const files = documents.filter((document) => document.fileType === ResponseItemType.File && !!document.extension\r\n            && filterFileTypes.findIndex(x=>x==document.extension) > -1);\r\n        const folders = documents.filter((document) => document.fileType === ResponseItemType.Folder);\r\n\r\n        let sortedFolders = _copyAndSort<IDocument>(folders, \"name\", false);\r\n        let sortedFiles = _copyAndSort<IDocument>(files, \"name\", false);\r\n\r\n        const filesAndFolders = { files: sortedFiles, folders: sortedFolders };\r\n        console.log(\"getSharedFlowsheetsItems results:\", filesAndFolders);\r\n        return filesAndFolders;\r\n\r\n    } catch (error) {\r\n        console.log(\"Error while getting List items:\", error);\r\n    }\r\n\r\n}\r\n\r\nexport async function OpenDwsimFile(driveItemId: string, driveId: string) {\r\n    if (chrome?.webview?.hostObjects?.filePickerService) {\r\n\r\n        const filePickerService = chrome.webview.hostObjects.filePickerService;\r\n        await filePickerService.openFile(driveItemId, driveId);\r\n    } else {\r\n        throw \"filePickerService not initialized.\";\r\n    }\r\n\r\n}\r\n\r\nexport async function SaveDwsimFile(filename: string, extension: string, flowsheetsDriveId: string, parentDriveId: string) {\r\n    if (chrome?.webview?.hostObjects?.filePickerService) {\r\n\r\n        const filePickerService = chrome.webview.hostObjects.filePickerService;\r\n        await filePickerService.SaveFile(filename, extension, flowsheetsDriveId, parentDriveId);\r\n    } else {\r\n        throw \"filePickerService not initialized.\";\r\n    }\r\n\r\n}\r\n\r\nexport async function CreateFolder(folderName: string, flowsheetsDriveId: string, parentDriveId: string) {\r\n\r\n    if (chrome?.webview?.hostObjects?.filePickerService) {\r\n\r\n        const filePickerService = chrome.webview.hostObjects.filePickerService;\r\n        await filePickerService.CreateFolder(folderName, flowsheetsDriveId, parentDriveId);\r\n    } else {\r\n        throw \"filePickerService not initialized.\";\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { Icon, IIconProps } from '@fluentui/react/lib/Icon';\r\nimport { IFileTypeIconOptions } from '@uifabric/file-type-icons';\r\n\r\nexport interface IFileTypeIconProps extends IFileTypeIconOptions {\r\n  iconName?: string;\r\n  IconUrl?: string;\r\n  width?: number;\r\n  height?: number;\r\n  alt?: string;\r\n  className?: string;\r\n  onClick?: () => void\r\n}\r\n\r\nexport const FileTypeIcon: React.FunctionComponent<IFileTypeIconProps> = (props: IFileTypeIconProps) => {\r\n  \r\n  if (!props.IconUrl) {\r\n    return <Icon {...props}\r\n      onClick={props.onClick} />\r\n  }\r\n  else {\r\n    return <img src={props.IconUrl} className={props.className} {...props}/>\r\n      \r\n\r\n  }\r\n\r\n}","\r\nexport interface ICustomFileTypeToIconMap{\r\n    [key: string]: { extensions?: string[], imageUrl:string } \r\n}\r\nexport const CustomFileTypeToIconMap:ICustomFileTypeToIconMap = { \r\n    dwxml: {\r\n        extensions: ['dwxml', 'dwxmz'],\r\n        imageUrl:require(\"../../assets/icons/file-types/dwsim.png\")\r\n    },\r\n    folder:{\r\n        extensions:['folder'],\r\n        imageUrl:require(\"../../assets/icons/file-types/folder.svg\")\r\n    }\r\n  \r\n};","import { IFileTypeIconOptions, getFileTypeIconProps } from \"@uifabric/file-type-icons\";\r\nimport { CustomFileTypeToIconMap, ICustomFileTypeToIconMap } from './file-type-icon.data';\r\nimport { IFileTypeIconProps } from './file-type-icon.component';\r\n\r\nexport interface IFileTypeIconCustomOptions extends IFileTypeIconOptions {\r\n    width: number;\r\n    height: number;\r\n}\r\n\r\nexport const getFileTypeIconPropsCustom = (options: IFileTypeIconCustomOptions): IFileTypeIconProps | { iconName: string; } => {\r\n\r\n\r\n    const IconUrl = (getIconImageUrl(options.extension??\"\") as any).default;\r\n    console.log(\"IconURl\",IconUrl);\r\n    if (IconUrl && IconUrl !== null && IconUrl !== \"\") {\r\n        return { IconUrl: IconUrl, ...options } as IFileTypeIconProps;\r\n    }\r\n    else {\r\n        return getFileTypeIconProps(options);\r\n    }\r\n}\r\n\r\n\r\nfunction getIconImageUrl(extension: string): string {\r\n\r\n    if (extension && extension != \"\") {\r\n        for (const iconName in CustomFileTypeToIconMap) {\r\n            const extensions = CustomFileTypeToIconMap[iconName].extensions;\r\n\r\n            if (extensions) {\r\n                for (let i = 0; i < extensions.length; i++) {\r\n                    if (extensions[i].toLowerCase() == extension.toLowerCase()) {\r\n                        return CustomFileTypeToIconMap[iconName].imageUrl;\r\n                    }\r\n\r\n                }\r\n\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n    return \"\";\r\n}\r\n\r\n\r\nexport const getFileExtension = (filename: string) => {\r\n    var filenameArray = filename.split('.');\r\n    if (filenameArray && filenameArray.length > 1) {\r\n        return filenameArray.pop();\r\n    } else {\r\n        return undefined;\r\n    }\r\n}","import * as React from 'react'\r\nimport { RouteComponentProps, useLocation } from 'react-router-dom';\r\nimport { useState } from 'react';\r\nimport * as History from \"history\";\r\nimport { ISelectedFolder } from \"../../interfaces/documents/document.interfaces\";\r\nimport { Breadcrumb, IBreadcrumbItem, Icon, IconButton } from '@fluentui/react';\r\nimport { msGraphClient } from \"../../shared/ms-graph/ms-graph-factory\"\r\n\r\nexport interface INavigationBarRouteProps {\r\n\r\n}\r\n\r\nexport interface INavigationBarProps {\r\n    selectedFolder: ISelectedFolder;\r\n    baseFolder: ISelectedFolder;\r\n    siteId: string;\r\n    flowsheetsListId: string;\r\n    onSelectedFolderChanged(selectedFolder: ISelectedFolder): void;\r\n}\r\nexport interface INavigationBarState {\r\n    folders: ISelectedFolder[];\r\n}\r\n\r\n\r\nexport interface IBreadcrumbItemWrapper {\r\n    breadcrumb: IBreadcrumbItem;\r\n    path: string;\r\n}\r\n\r\nclass NavigationBar extends React.Component<INavigationBarProps, INavigationBarState> {\r\n\r\n\r\n    /**\r\n     *\r\n     */\r\n    constructor(props: INavigationBarProps) {\r\n        super(props);\r\n        this.state = { folders: [props.baseFolder] };\r\n    }\r\n    componentDidUpdate(prevProps: INavigationBarProps, prevState: INavigationBarState) {\r\n        //navigate down the folder structure\r\n        const { folders } = prevState;\r\n        const alreadyInFolders = folders.find(x => x.driveId === this.props.selectedFolder.driveId);\r\n        if (!alreadyInFolders) {\r\n            console.log(\"Navigating to:\",this.props.selectedFolder);\r\n            this.setState({ folders: [...folders, this.props.selectedFolder] });\r\n        }\r\n    }\r\n\r\n    async getSelectedFolder(selectedFolderPath: string) {\r\n\r\n        if (selectedFolderPath === this.props.baseFolder.webUrl) {\r\n            return { ...this.props.baseFolder };\r\n        }\r\n\r\n        console.log(\"CurrentFolder path:\", selectedFolderPath);\r\n        const folderPath = selectedFolderPath.split('/').slice(1).reduce((prev, curr) => prev + \"/\" + curr, \"\");\r\n        console.log(\"getSelectedFolder path:\", folderPath);\r\n\r\n        let apiPath = `/sites/${this.props.siteId}/lists/${this.props.flowsheetsListId}/drive`;\r\n        if (folderPath && folderPath !== \"\" && folderPath !== \"/\") {\r\n            apiPath = `/sites/${this.props.siteId}/lists/${this.props.flowsheetsListId}/drive/root:${folderPath}`;\r\n        }\r\n\r\n\r\n        var folderInfo = await msGraphClient.api(apiPath).get();\r\n        let selectedFolder = {\r\n            driveId: folderInfo.id,\r\n            displayName: folderInfo.name,\r\n            webUrl: selectedFolderPath\r\n        } as ISelectedFolder;\r\n        return selectedFolder;\r\n\r\n    }\r\n\r\n\r\n    // addSelectedFolder(folder: ISelectedFolder) {\r\n    //     console.log(\"addSelectedFolder\",folder);\r\n    //     this.setState(s => ({ folders: [...s.folders, folder] }));\r\n    // }\r\n\r\n    getBreadcrumbItems() {\r\n        const items: IBreadcrumbItem[] = this.state.folders.map((folder, index) => {\r\n            let isCurrent = (this.state.folders.length - 1) == index;\r\n\r\n            return { text: folder.displayName, key: index.toString(), onClick: () => this._onBreadcrumbItemClicked.call(this, index), isCurrentItem: isCurrent };\r\n\r\n        });\r\n\r\n        return items;\r\n    }\r\n\r\n    _onBreadcrumbItemClicked(index: number) {\r\n        let { folders } = this.state;\r\n        folders.splice(index + 1);\r\n        this.setState({ folders: folders });\r\n        this.props.onSelectedFolderChanged(folders[folders.length - 1]);\r\n    }\r\n\r\n    onNavigateUpClick() {\r\n        let { folders } = this.state;\r\n        if (folders.length > 1) {\r\n            folders.pop();\r\n\r\n            this.setState({ folders: folders });\r\n            this.props.onSelectedFolderChanged(folders[folders.length - 1]);\r\n        }\r\n\r\n\r\n\r\n    }\r\n\r\n    render() {\r\n        const items = this.getBreadcrumbItems();\r\n\r\n        //     return  <Breadcrumb           \r\n        //     items={items}\r\n        //     maxDisplayedItems={3}\r\n        // />\r\n        const lastItem = items.findIndex(x => x.isCurrentItem);\r\n        const showIcon = this.state.folders[lastItem].driveId !== this.props.baseFolder.driveId;\r\n\r\n        return <div style={{ display: \"flex\", alignItems: \"center\" }}>\r\n            {showIcon && <IconButton iconProps={{ iconName: 'Up' }} styles={{ root: { margin: \"11px 0px 1px\" } }} onClick={this.onNavigateUpClick.bind(this)} />}\r\n\r\n            <div style={{ minWidth: \"100%\" }}>\r\n                <Breadcrumb\r\n                    items={items}\r\n                    maxDisplayedItems={3}\r\n                />\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport default NavigationBar","import { DefaultButton, Dialog, DialogFooter, DialogType, IModalProps, PrimaryButton, TextField } from \"@fluentui/react\";\r\nimport * as React from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { CreateFolder } from \"../../api/documents.api\";\r\nimport { ISelectedFolder } from \"../../interfaces/documents/document.interfaces\";\r\n\r\ninterface ICreateFolderModalProps {\r\n   selectedFolder:ISelectedFolder;\r\n   flowsheetsDriveId:string;\r\n    onHide():void;\r\n    onFolderCreated():void;\r\n}\r\n\r\n\r\nconst modelProps = {\r\n    isBlocking: true,\r\n    topOffsetFixed: true\r\n\r\n} as IModalProps;\r\n\r\nconst dialogContentProps = {\r\n    type: DialogType.normal,\r\n    title: 'Create Folder'\r\n   \r\n  };\r\n\r\nconst CreateFolderModal: React.FC<ICreateFolderModalProps> = (props) => {\r\n\r\n\r\n\r\n    \r\n    const { register, handleSubmit, watch, formState: { errors } } = useForm();\r\n    const onSubmit = async (data:{foldername:string}) => {\r\n        \r\n     await   CreateFolder(data.foldername,props.flowsheetsDriveId,props.selectedFolder.driveId);\r\n     props.onFolderCreated();\r\n    }\r\nconsole.log(\"errors\",errors);\r\n    return <Dialog\r\n        hidden={false}\r\n        dialogContentProps={dialogContentProps}\r\n        onDismiss={props.onHide}\r\n        minWidth={\"350px\"}\r\n    \r\n        modalProps={modelProps}>\r\n        <form onSubmit={handleSubmit(onSubmit)}>\r\n\r\n            <TextField  {...register(\"foldername\", { required: true })} placeholder=\"Folder name\"/>\r\n            {errors.foldername && <span className=\"text-danger\" style={{margin:\"3px 5px\"}}>Folder name is required.</span>}\r\n\r\n            <DialogFooter>\r\n                <PrimaryButton type=\"submit\" text=\"Create\" />\r\n                <DefaultButton onClick={props.onHide} text=\"Cancel\" />\r\n            </DialogFooter>\r\n        </form>\r\n    </Dialog>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n}\r\n\r\n\r\nexport default CreateFolderModal","import * as React from \"react\";\r\nimport { RouteComponentProps } from \"react-router-dom\";\r\nimport { IDocument, ISelectedFolder, ResponseItemType } from \"../interfaces/documents/document.interfaces\";\r\nimport { getFlowsheetListItemsAsync, OpenDwsimFile, SaveDwsimFile } from \"../api/documents.api\";\r\nimport { DetailsListLayoutMode, SelectionMode, ShimmeredDetailsList, Selection, mergeStyleSets, IColumn, CheckboxVisibility, TextField, PrimaryButton, Dropdown, DefaultButton, ISelectionOptions, ConstrainMode, IDetailsListStyles, IRenderFunction, IDetailsHeaderProps, TooltipHost, IDetailsColumnRenderTooltipProps, IDetailsFooterProps, DetailsRow, IStyle, StickyPositionType, Sticky, ScrollablePane, IScrollablePaneStyles, IDropdownOption } from \"@fluentui/react\";\r\nimport moment from \"moment\";\r\nimport { FileTypeIcon, IFileTypeIconProps } from \"../components/file-type-icon/file-type-icon.component\";\r\nimport { getFileTypeIconPropsCustom } from \"../components/file-type-icon/file-type-icon.helpers\";\r\nimport NavigationBar from \"../components/navigation-bar/navigation-bar.component\";\r\nimport CreateFolderModal from \"../components/create-folder-modal/create-folder-modal.component\";\r\nimport { IInitializeDashboardProps, withInitializeDashboard } from \"../components/with-initialize-dashboard.hoc\";\r\n\r\ninterface IOpenDashboardFilePageProps extends RouteComponentProps<IOpenDashboardFilePageRouteProps>, IInitializeDashboardProps {\r\n    baseFolder: ISelectedFolder;\r\n    siteId: string;\r\n    flowsheetsDriveId: string;\r\n    flowsheetsListId: string;\r\n    isSaveDialog: boolean;\r\n\r\n}\r\ninterface IOpenDashboardFilePageRouteProps {\r\n    extension?: string;\r\n}\r\n\r\ninterface IOpenDashboardFilePageState {\r\n    files: IDocument[];\r\n    folders: IDocument[];\r\n    selectedFolder: ISelectedFolder;\r\n    isDataLoaded: boolean;\r\n    filename?: string;\r\n    selectedFileType?: string;\r\n    filterFileTypes: string[];\r\n    showCreateFolderModal: boolean;\r\n}\r\n\r\nconst gridStyles: Partial<IDetailsListStyles> = {\r\n    root: {\r\n        selectors: {\r\n            '.ms-DetailsRow': {\r\n                minWidth: \"calc(100vw - 50px) !important\"\r\n            } as IStyle\r\n        },\r\n    }\r\n};\r\n\r\nconst classNames = mergeStyleSets({\r\n    header: {\r\n        margin: 0,\r\n        height: \"50px\"\r\n    },\r\n    row: {\r\n        flex: '0 0 auto',\r\n    },\r\n    wrapper: {\r\n        height: '40vh',\r\n        position: 'relative',\r\n        backgroundColor: 'white',\r\n    },\r\n    fileIconHeaderIcon: {\r\n        padding: 0,\r\n        fontSize: '16px',\r\n    },\r\n    fileIconCell: {\r\n        display: \"flex !important\",\r\n        alignItems: \"center\",\r\n        textAlign: 'center',\r\n        selectors: {\r\n            '&:before': {\r\n                content: '.',\r\n                display: 'inline-block',\r\n                verticalAlign: 'middle',\r\n                height: '100%',\r\n                width: '0px',\r\n                visibility: 'hidden',\r\n            },\r\n        },\r\n    },\r\n    fileIconImg: {\r\n        verticalAlign: 'middle',\r\n        maxHeight: '20px',\r\n        maxWidth: '20px',\r\n    },\r\n    controlWrapper: {\r\n        display: 'flex',\r\n        flexWrap: 'wrap',\r\n    },\r\n    exampleToggle: {\r\n        display: 'inline-block',\r\n        marginBottom: '10px',\r\n        marginRight: '30px',\r\n    },\r\n    selectionDetails: {\r\n        marginBottom: '20px',\r\n    },\r\n    commandbarInfoIcon: {\r\n        border: \"none\"\r\n    },\r\n    remarkCell: {\r\n        whiteSpace: \"pre-line !important\",\r\n        selectors: {\r\n            'span': {\r\n                overflow: \"hidden !important\",\r\n                textOverflow: \"ellipsis !important\",\r\n                display: \"-webkit-box !important\",\r\n                ...({ '-webkit-line-clamp': '2 !important' } as any),\r\n                ...({ '-webkit-box-orient': 'vertical !important' } as any)\r\n            }\r\n        }\r\n    },\r\n    dateModifiedColumn: {\r\n        textAlign: \"center\",\r\n        justifyContent: \"center\",\r\n        selectors: {\r\n            '.ms-DetailsHeader-cellTitle': {\r\n                justifyContent: \"center\",\r\n                paddingRight: \"32px\"\r\n            }\r\n        }\r\n    },\r\n    column: {\r\n        display: \"flex !important\",\r\n        textAlign: \"center\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        selectors: {\r\n            '.ms-DetailsHeader-cellTitle': {\r\n                justifyContent: \"center\"\r\n            }\r\n        }\r\n\r\n    },\r\n    sharedColumn: {\r\n        textAlign: \"center\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        fontSize: \"18px\",\r\n        selectors: {\r\n            '.ms-DetailsHeader-cellTitle': {\r\n                justifyContent: \"center\"\r\n            }\r\n        }\r\n    },\r\n    breadcrumbsticky: {\r\n        height: \"100px\"\r\n    },\r\n    tableStyle: {\r\n        selectors: {\r\n            '.ms-DetailsRow-cell': {\r\n                ...({ 'display': 'flex !important' } as any),\r\n                alignItems: \"center\"\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\nclass OpenDashboardFilePage extends React.Component<IOpenDashboardFilePageProps, IOpenDashboardFilePageState>{\r\n    private _navigationBarRef: React.RefObject<NavigationBar> | undefined;\r\n    private _selection: Selection;\r\n\r\n\r\n    constructor(props: IOpenDashboardFilePageProps) {\r\n        super(props);\r\n        this.state = {\r\n            files: [],\r\n            folders: [],\r\n            selectedFolder: props.baseFolder,\r\n            isDataLoaded: false,\r\n            //   isSaveDialog: false,\r\n            filename: '',\r\n            selectedFileType: \"dwxmz\",\r\n            filterFileTypes: [\"dwxml\", \"dwxmz\"],\r\n            showCreateFolderModal: false\r\n        };\r\n        this._navigationBarRef = React.createRef<NavigationBar>();\r\n        this._selection = new Selection({ onSelectionChanged: this.selectedRowChanged.bind(this) } as ISelectionOptions);\r\n\r\n    }\r\n    componentDidMount() {\r\n\r\n        if (this.props.isSaveDialog) {\r\n            this.changeFileTypeFilter();\r\n        } else {\r\n            this.getFilesAndFolders();\r\n\r\n        }\r\n\r\n\r\n    }\r\n\r\n    changeFileTypeFilter() {\r\n\r\n        if (this.props.match?.params?.extension) {\r\n            const fileTypeExtensions = this.props.match.params.extension.split('_');\r\n\r\n            this.setState({ selectedFileType: fileTypeExtensions[0], filterFileTypes: fileTypeExtensions },\r\n                () => { this.getFilesAndFolders() });\r\n            console.log(\"Query params\", this.props.match?.params?.extension);\r\n        } else {\r\n            this.getFilesAndFolders()\r\n        }\r\n    }\r\n\r\n    async getFilesAndFolders() {\r\n        const { selectedFolder, filterFileTypes, selectedFileType } = this.state;\r\n        const { siteId, flowsheetsListId } = this.props;\r\n        try {\r\n            this.setState({ isDataLoaded: false });\r\n            const fileTypes = (selectedFileType == \"dwxml\" || selectedFileType == \"dwxmz\") ? filterFileTypes : [selectedFileType!];\r\n            const filesAndFolders = await getFlowsheetListItemsAsync(selectedFolder, siteId, flowsheetsListId, fileTypes);\r\n            console.log(\"Files and folders\", filesAndFolders);\r\n            this.setState({ files: filesAndFolders!.files ?? [], folders: filesAndFolders!.folders ?? [] });\r\n        } catch (error) {\r\n            console.log(\"An error occurred while loading dashboard files\", error);\r\n        }\r\n        finally {\r\n            this.setState({ isDataLoaded: true });\r\n        }\r\n    }\r\n\r\n\r\n    private selectedRowChanged(): void {\r\n        const selection = this._selection.getSelection();\r\n\r\n        const { selectedFolder } = this.state;\r\n        const { isSaveDialog } = this.props;\r\n        if (selection && selection.length > 0) {\r\n            const item = selection[0] as IDocument;\r\n            if (item.fileType == ResponseItemType.Folder) {\r\n                let folderPath = `/${encodeURIComponent(item.name)}`;\r\n\r\n                folderPath = this.state.selectedFolder.webUrl + folderPath;\r\n                let newSelectedFolder = {\r\n                    driveId: item.driveItemId,\r\n                    displayName: item.name,\r\n                    webUrl: folderPath,\r\n                    parentDriveItemId: selectedFolder.driveId\r\n                } as ISelectedFolder;\r\n                console.log(\"Setting selected folder\", newSelectedFolder);\r\n                //   this._navigationBarRef?.current?.addSelectedFolder(newSelectedFolder);\r\n\r\n                this.setState({ selectedFolder: newSelectedFolder }, () => {\r\n                    this.getFilesAndFolders();\r\n                });\r\n            } else {\r\n                if (!isSaveDialog) {\r\n                    OpenDwsimFile(item.driveItemId, this.props.flowsheetsDriveId).then(() => { }, (error) => { alert(error); });\r\n                } else {\r\n                    let nameArray = item.name.split('.');\r\n                    if (nameArray.length > 1)\r\n                        nameArray.pop();\r\n                    const fileName = nameArray.reduce((prev, curr) => prev + curr, \"\");\r\n                    this.setState({ filename: fileName });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private getColumns = (): IColumn[] => {\r\n\r\n\r\n\r\n        const nameContainerStyle = { display: \"flex\", flexDirection: \"row\", flex: 1, alignItems: \"center\" } as React.CSSProperties;\r\n        const documentNameStyle = { overflow: \"hidden\" } as React.CSSProperties;\r\n\r\n\r\n        let columns: IColumn[] = [\r\n            {\r\n                key: 'file-type',\r\n                name: 'File Type',\r\n                className: classNames.fileIconCell,\r\n                iconClassName: classNames.fileIconHeaderIcon,\r\n                ariaLabel: 'Column operations for File type, Press to sort on File type',\r\n                iconName: 'Page',\r\n                isIconOnly: true,\r\n                fieldName: 'icon',\r\n                minWidth: 18,\r\n                maxWidth: 20,\r\n                onRender: (item: IDocument) => {\r\n                    const isFolder = item.fileType == ResponseItemType.Folder;\r\n                    return <FileTypeIcon {...getFileTypeIconPropsCustom(\r\n                        {\r\n                            extension: item.extension,\r\n                            size: 20,\r\n                            width: 20,\r\n                            height: 20\r\n\r\n                        }) as IFileTypeIconProps} />\r\n                },\r\n            },\r\n            {\r\n                key: 'name',\r\n                name: 'Name',\r\n                fieldName: 'name',\r\n                minWidth: 150,\r\n\r\n                maxWidth: 400,\r\n                isRowHeader: true,\r\n                isResizable: true,\r\n                className: classNames.column,\r\n                data: 'string',\r\n                onRender: (item: IDocument, i) => {\r\n\r\n                    const isFolder = item.fileType == ResponseItemType.Folder;\r\n\r\n                    return (<div className=\"document-name-container\" style={nameContainerStyle}>\r\n                        <div className=\"document-name\" style={documentNameStyle}>\r\n                            {item.name ? <span className=\"kt-font-bold\">{item.name}</span> : null}\r\n\r\n                        </div>\r\n                    </div>\r\n                    );\r\n\r\n                },\r\n                // isPadded: true,\r\n            },\r\n\r\n\r\n            {\r\n                key: 'date',\r\n                name: 'Modified At',\r\n                fieldName: 'dateModified',\r\n                minWidth: 135,\r\n\r\n                maxWidth: 200,\r\n                isResizable: true,\r\n                isCollapsible: true,\r\n                isMultiline: true,\r\n                headerClassName: classNames.dateModifiedColumn,\r\n                className: classNames.dateModifiedColumn,\r\n\r\n                data: 'string',\r\n                onRender: (item: IDocument) => {\r\n                    return <span>{moment(item.dateModified).format(\"ddd DD MMM YYYY\")}\r\n                        <br />{moment(item.dateModified).format(\"HH:mm:ss\")}  </span>;\r\n                },\r\n                isPadded: true,\r\n            },\r\n\r\n\r\n            {\r\n                key: 'tags',\r\n                name: 'Tags',\r\n                fieldName: 'tags',\r\n                minWidth: 180,\r\n                maxWidth: 250,\r\n                isResizable: true,\r\n                isCollapsible: true,\r\n                data: 'string',\r\n                onRender: (item: IDocument) => {\r\n                    if (item.tags && item.tags.length > 0) {\r\n                        const tags = item.tags.reduce((prev, curr, currindex, []) => { return { key: (1).toString(), name: prev.name + \", \" + curr.name, isNewItem: false } });\r\n                        return (<span style={{ whiteSpace: \"initial\" }}>{tags.name}</span>);\r\n                    }\r\n                    return (<span></span>);\r\n                },\r\n                isPadded: true,\r\n            },\r\n            {\r\n                key: 'remark',\r\n                name: 'Remark',\r\n                fieldName: 'remark',\r\n                minWidth: 80,\r\n                maxWidth: 350,\r\n                isResizable: true,\r\n                isCollapsible: true,\r\n                isMultiline: true,\r\n                className: classNames.remarkCell,\r\n                data: 'string',\r\n\r\n                onRender: (item: IDocument) => {\r\n                    return <span>{item.remark}</span>;\r\n                },\r\n            }\r\n        ];\r\n        return columns;\r\n    }\r\n\r\n    onRenderDetailsHeader: IRenderFunction<IDetailsHeaderProps> = (props, defaultRender) => {\r\n\r\n        const { siteId, baseFolder, flowsheetsListId } = this.props;\r\n        return (\r\n\r\n            <Sticky stickyPosition={StickyPositionType.Header} key=\"header_sticky\" stickyBackgroundColor={\"white\"} >\r\n                <NavigationBar\r\n                    ref={this._navigationBarRef}\r\n                    siteId={siteId}\r\n                    flowsheetsListId={flowsheetsListId}\r\n                    baseFolder={baseFolder}\r\n                    selectedFolder={this.state.selectedFolder}\r\n                    onSelectedFolderChanged={(selectedFolder) => {\r\n                        this.setState({ selectedFolder: selectedFolder }, () => {\r\n                            this.getFilesAndFolders();\r\n                        });\r\n                    }} />\r\n                {defaultRender!(props)}\r\n            </Sticky>\r\n        )\r\n    };\r\n\r\n\r\n\r\n    onSaveFileClick() {\r\n        console.log(\"Save clicked\", this.state);\r\n        const { filename, selectedFileType, selectedFolder } = this.state;\r\n        const { flowsheetsDriveId } = this.props;\r\n        if (filename && selectedFileType)\r\n            SaveDwsimFile(filename, selectedFileType, flowsheetsDriveId, selectedFolder.driveId);\r\n    }\r\n\r\n    render() {\r\n        const { folders, files, isDataLoaded, selectedFolder, filename, selectedFileType, filterFileTypes, showCreateFolderModal } = this.state;\r\n        const { isSaveDialog } = this.props;\r\n        const { siteId, flowsheetsListId, baseFolder, } = this.props;\r\n        const columns = [...this.getColumns()];\r\n        const items = [...folders, ...files];\r\n        console.log(\"isDataLoaded\", isDataLoaded);\r\n\r\n\r\n        const dropdownControlledExampleOptions = getDropDownOptions(filterFileTypes);\r\n\r\n\r\n        return <div style={{ height: '100%', display: 'flex', flexDirection: 'column' }} >\r\n            {isSaveDialog && <div style={{ marginLeft: \"30px\" }}>\r\n                <div style={{ display: \"flex\", marginBottom: \"5px\", marginTop: \"5px\" }}>\r\n                    <div style={{ flexBasis: \"80%\" }} >\r\n                        <TextField placeholder=\"Enter file name here\" value={filename} onChange={(ev, newValue) => this.setState({ filename: newValue })} />\r\n                    </div>\r\n                    <div style={{ flexBasis: \"20%\" }}>\r\n                        <DefaultButton text=\"New Folder\" styles={{ root: { marginLeft: \"10px\" } }} onClick={() => this.setState({ showCreateFolderModal: true })} />\r\n                    </div>\r\n\r\n                </div>\r\n                <div style={{ display: \"flex\", marginBottom: \"5px\", marginTop: \"5px\" }} >\r\n                    <div style={{ flexBasis: \"80%\" }}>\r\n                        <Dropdown\r\n                            selectedKey={selectedFileType}\r\n                            placeholder=\"Select an option\"\r\n                            options={dropdownControlledExampleOptions}\r\n                            onChange={(e, option) => { this.setState({ selectedFileType: option?.key.toString() },()=>{this.getFilesAndFolders();}); }}\r\n\r\n                        />\r\n                    </div>\r\n                    <div style={{ flexBasis: \"20%\" }}>\r\n                        <PrimaryButton text=\"Save\" styles={{ root: { marginLeft: \"10px\" } }} onClick={this.onSaveFileClick.bind(this)} />\r\n                    </div>\r\n                </div>\r\n\r\n\r\n                {showCreateFolderModal && <CreateFolderModal\r\n                    onFolderCreated={() => { this.setState({ showCreateFolderModal: false }); this.getFilesAndFolders(); }}\r\n                    selectedFolder={selectedFolder}\r\n                    flowsheetsDriveId={this.props.flowsheetsDriveId}\r\n                    onHide={() => this.setState({ showCreateFolderModal: false })} />}\r\n            </div>\r\n            }\r\n\r\n            <div style={{ flex: 1, display: 'flex', flexDirection: 'row', minHeight: \"300px\" }}>\r\n                {/* We need this div because scrollable pane has position absolute, to make it full height */}\r\n                <div style={{ position: 'relative', flex: 1 }}>\r\n                    <ScrollablePane styles={{ root: { marginLeft: \"30px\" } }}>\r\n                        <ShimmeredDetailsList\r\n                            enableShimmer={!isDataLoaded}\r\n                            items={items}\r\n                            columns={columns}\r\n                            selection={this._selection}\r\n                            layoutMode={DetailsListLayoutMode.fixedColumns}\r\n                            constrainMode={ConstrainMode.unconstrained}\r\n                            onRenderDetailsHeader={this.onRenderDetailsHeader.bind(this)}\r\n                            selectionMode={SelectionMode.single}\r\n                            checkboxVisibility={CheckboxVisibility.hidden}\r\n                            onShouldVirtualize={() => false}\r\n                            setKey=\"none\"\r\n                            detailsListStyles={gridStyles}\r\n                            isHeaderVisible={true}\r\n                        // onItemInvoked={this._onItemInvoked.bind(this)}\r\n\r\n                        />\r\n                    </ScrollablePane>\r\n                </div>\r\n            </div>\r\n\r\n        </div>;\r\n\r\n\r\n\r\n    }\r\n}\r\n\r\nfunction getDropDownOptions(fileExtensions: string[]): IDropdownOption[] {\r\n\r\n    let options: IDropdownOption[] = [];\r\n\r\n    fileExtensions.forEach(extension => {\r\n        const option = getFileTypeDropdownOption(extension);\r\n        if (option) {\r\n            options.push(option);\r\n        }\r\n    });\r\n\r\n    return options;\r\n\r\n}\r\n\r\nfunction getFileTypeDropdownOption(extension?: string): IDropdownOption | undefined {\r\n\r\n\r\n    switch (extension) {\r\n        case 'dwxmz': return { key: 'dwxmz', text: 'Simulation File (Compressed XML) (*.dwxmz)' };    \r\n        case 'xlsx': return { key: 'xlsx', text: 'Excel Workbook (*.xlsx)' };\r\n        case 'odt': return { key: 'odt', text: 'OpenOffice Writer Document (*.odt)' };\r\n        case 'pdf': return { key: 'pdf', text: 'PDF Files (*.pdf)' };\r\n        case 'ods': return { key: 'ods', text: 'OpenOffice Calc SpreadSheet (*.ods)' };\r\n\r\n        default:\r\n            return undefined;\r\n    }\r\n\r\n}\r\n\r\nexport default withInitializeDashboard(OpenDashboardFilePage);","import { DefaultButton, PrimaryButton } from \"@fluentui/react\";\r\nimport * as React from \"react\";\r\ndeclare const chrome: any;\r\n\r\n\r\ninterface IHomePageProps {\r\n\r\n}\r\n\r\nconst LoginIntroPage: React.FC<IHomePageProps> = () => {\r\n\r\n    const onRegisterClick = async () => {\r\n        try {\r\n            const systemService = chrome?.webview?.hostObjects?.systemService;\r\n            systemService.openUrlInLocalBrowser(\"https://simulate365.com/registration-dwsim-pro/\");\r\n        } \r\n        catch (error) {\r\n            console.log(\"An error occurred while navigating to register page.\", error);\r\n        }\r\n\r\n    }\r\n\r\n    const onLoginClick = async () => {\r\n        try {\r\n            if (chrome?.webview?.hostObjects?.authService) {\r\n                const authService = chrome.webview.hostObjects.authService;\r\n                await authService.navigateToLoginPage();\r\n            } else {\r\n                alert(\"auth Service not initialized.\");\r\n            }\r\n        } catch (error) {\r\n            console.log(\"An error occurred while navigating to login page.\", error);\r\n        }\r\n    }\r\n\r\n    const OpenAnchorInSystemBrowser = (e: React.MouseEvent<HTMLAnchorElement, MouseEvent>) => {\r\n        e.preventDefault();\r\n\r\n        let nativeEvent = e.nativeEvent as PointerEvent;\r\n\r\n        for (let element of (e.nativeEvent as any).path) {\r\n            if (element.tagName == 'A') {\r\n                const systemService = chrome?.webview?.hostObjects?.systemService;\r\n                if (!systemService) {\r\n                    alert(\"SystemService not available.\");\r\n                }\r\n                else {\r\n                    let url = element.href;\r\n                    systemService.openUrlInLocalBrowser(url);\r\n                }\r\n\r\n                return false; // Element found, stop execution\r\n            }\r\n        }\r\n\r\n        alert(\"OpenAnchorInSystemBrowser() supports only 'a' element. 'a' element not found in invocation path.\");\r\n\r\n        return false;\r\n    }\r\n\r\n    return <div style={{ height: \"100%\", display: \"flex\", flexDirection: \"column\", justifyContent: 'center', padding: \"0px 20px\" }}>\r\n        <div style={{ marginLeft: 'auto', marginRight: 'auto', marginBottom: '16px' }}>\r\n            <a href=\"https://simulate365.com\" onClick={OpenAnchorInSystemBrowser}><img src=\"/s365-full-logo.png\" style={{ width: '250px' }} /></a>\r\n        </div>\r\n        <p>\r\n            Access <b>Simulate 365 DASHBOARD</b>, the \"all in one place\" simulation platform and use it free for:\r\n            <ul>\r\n                <li>Intelligent file management</li>\r\n                <li>Syncing simulation files from DASHBOARD to DWSIM</li>\r\n                <li>Easier team collaboration</li>\r\n            </ul>\r\n        </p>\r\n        <div style={{ marginLeft: 'auto', marginRight: 'auto', marginBottom: '16px' }}>\r\n            <PrimaryButton text=\"Register\" onClick={() => onRegisterClick()} style={{ marginRight: \"10px\" }} />\r\n            <DefaultButton text=\"Login\" onClick={() => onLoginClick()} />\r\n        </div>\r\n        <p>\r\n            Discover <b>DWSIM Pro</b> and other Simulate 365 tools:\r\n            <ul>\r\n                <li>PPBDesigner for Population Balance Modeling</li>\r\n                <li>Multivariate Senstivity Study (MSS)</li>\r\n                <li>Design of Experiments (DoE)</li>\r\n                <li>Take-Home Exercises/Exams (THEE)</li>\r\n                <li>And more!</li>\r\n            </ul>\r\n        </p>\r\n    </div>;\r\n}\r\n\r\n\r\nexport default LoginIntroPage;","import React from 'react';\r\nimport './App.css';\r\nimport { Route } from 'react-router-dom';\r\nimport OpenDashboardFilePage from \"./pages/open-dashboard-file.component\";\r\nimport LoginIntroPage from \"./pages/login-intro.component\";\r\n\r\n\r\n//used only when opening in browser while developing\r\n\r\nconst  App =()=> {\r\n \r\n\r\n    return <div className=\"App\">\r\n\r\n      <Route path=\"/filepicker/open\" exact component={OpenDashboardFilePage} />\r\n      <Route path=\"/filepicker/save/:extension?\" exact render={(props)=><OpenDashboardFilePage {...{isSaveDialog:true}} {...props} />} />\r\n\r\n      <Route path=\"/login/intro\" exact component={LoginIntroPage} />\r\n\r\n    </div>;\r\n  \r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { HashRouter } from \"react-router-dom\";\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport { initializeIcons } from '@fluentui/react/lib/Icons';\r\nimport { initializeFileTypeIcons } from '@uifabric/file-type-icons';\r\ninitializeIcons();\r\ninitializeFileTypeIcons();\r\nReactDOM.render(\r\n  <HashRouter>    \r\n    <App />\r\n    </HashRouter>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}